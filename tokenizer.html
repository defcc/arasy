<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>Javascript Tokenizer</title>
	<meta charset="utf-8"/>
	<style>
		body { font: 12px/13px arial}
		input{ vertical-align: middle}
		.actiontip { color: #aaa }
		#source{
			height: 150px;
			width: 500px;
		}
	</style>
</head>
<body>
<textarea id="source">
/**/
if(a == /a/g){console.log(/a/)}
/a/g;
var a = (/a/);
var a /= 1;
</textarea>
<p><label for="keepws">保留空白和换行符</label><input type="checkbox" name="keepws" id="keepws"/></p>
<p><label for="startState">开始状态</label><select  name="startState" id="startState">
    <option value="start">start</option>
    <option value="string">String</option>
    <option value="comment">Comment</option>
</select></p>
<p style="display: none;" id="string_quote_wrap"><label for="extValString">string开始标记</label><select name="extValString" id="extValString">
    <option value="'">单引号'</option>
    <option value='"'>双引号"</option>
</select></p>
<p style="display: none;" id="comment_wrap"><label for="extValComment">comment开始标记</label><select name="extValComment" id="extValComment">
    <option value="scomment">单行注释</option>
    <option value='mcomment'>多行注释</option>
</select></p>
<p><label for="startLine">开始行数：<input id="startLine" name="startLine" value="0"/></label></p>
<p><input type="button" value="lex parser result to console" id="btn"/></p>
<p><span class="actiontip">F12打开chrome控制台先</span></p>
</body>
</html>
<script type="text/javascript" src="lexer.js"></script>
<script>
var $ = function(id){ return document.getElementById( id )};
$('startState').onchange = function(){
    var styleMap = {
        'string': {'string_quote_wrap': 'block', 'comment_wrap': 'none'},
        'comment': {'string_quote_wrap': 'none', 'comment_wrap': 'block'},
        'start': {'string_quote_wrap': 'none', 'comment_wrap': 'none'}
    };
    var stateVal = this.value;
    var styleVal =  styleMap[stateVal];
    $('string_quote_wrap').style.display = styleVal['string_quote_wrap'];
    $('comment_wrap').style.display = styleVal['comment_wrap'];
};
function parse(){
    var codeStr = $('source').value;
	var keepWs  =  $('keepws').checked;
    var startState = $('startState').value;
    var startLineVal = +$('startLine').value;
    var startInfo = {
        startState: startState,
        startLine: startLineVal
    };
	if( startState == 'string' ){
        startInfo.extVal = $('extValString').value.charCodeAt(0);
    }else if( startState == 'comment' ){
        startInfo.extVal = $('extValComment').value;
    }

	var start = +new Date();


	var tokenList = YAP(codeStr, +keepWs, startInfo );
	console.log('time used:', (+new Date() - start));

	console.log(tokenList);
}

document.getElementById('btn').onclick = parse;
</script>